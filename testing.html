<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" name="viewport" content="IE=edge, chrome=1, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, minimal-u, viewport-fit=cover">
    <title id="title"></title>
    <link id = "dynamic-favicon" rel="shortcut icon" type="image/png" href="">
    <link rel="stylesheet" href="http://cosmos.phy.tufts.edu/~daniellangevagle/stylesheets/leaflet.css?version=1" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&#038;subset=latin%2Clatin-ext&#038;ver=4.4.2" type="text/css" media="all"/>
    <link rel="stylesheet" href="http://cosmos.phy.tufts.edu/~danilo/HFF/HFFexplorer/wp-content/themes/hffds/stylesheets/app.css?version=1" type="text/css" media="all"/>
    <link rel="stylesheet" href="http://cosmos.phy.tufts.edu/~daniellangevagle/stylesheets/grizliweb.css?version=0.55" type="text/css" media="all"/>
    <link rel="stylesheet" href="http://cosmos.phy.tufts.edu/~daniellangevagle/stylesheets/multirange.css?version=1" type="text/css" media="all"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js?ver=4.4.2"></script>
  </head>

  <body scroll="no" style="overflow: hidden;">
    <div class="disableTextHighlight" style="height: 100%; width: 100%;">
      <!-- Map -->
      <div id="map" style="cursor: crosshair; background: black; border: none; filter: brightness(1); -webkit-filter: brightness(1);" onkeydown="mapkey(event)" onkeyup="mapkey(event)"></div>
      <!-- Menu Container -->
      <button id="menuButton" class="menuButton update" type="button" title="Open menu" onclick="showHideMenu()"></button>
      <div id="menuContainer" class="menuContainer">
        <div id="settingsButton" class="menuOption" onclick="showSubMenu('settings')">
          <div id="settingsIcon" class="menuOptionIcon" style="background-image: url(http://cosmos.phy.tufts.edu/~daniellangevagle/icons/settingswhite.png?version=1);"></div>
          <div id="settingsText" class="menuOptionText">Settings</div>
          <div id="settingsIconBlue" class="menuOptionIconBlue" style="background-image: url(http://cosmos.phy.tufts.edu/~daniellangevagle/icons/settingsblue.png?version=1);"></div>
        </div>
        <div id="advancedSearchButton" class="menuOption" onclick="showSubMenu('advancedSearch')">
          <div id="advancedSearchIcon" class="menuOptionIcon" style="background-image: url(http://cosmos.phy.tufts.edu/~daniellangevagle/icons/advancedSearchwhite.png?version=1);"></div>
          <div id="advancedSearchText" class="menuOptionText">Advanced Search</div>
          <div id="advancedSearchIconBlue" class="menuOptionIconBlue" style="background-image: url(http://cosmos.phy.tufts.edu/~daniellangevagle/icons/advancedSearchblue.png?version=1);"></div>
        </div>
        <div id="keyboardButton" class="menuOption" onclick="showSubMenu('keyboard')">
          <div id="keyboardIcon" class="menuOptionIcon" style="background-image: url(http://cosmos.phy.tufts.edu/~daniellangevagle/icons/keyboardwhite.png?version=1);"></div>
          <div id="keyboardText" class="menuOptionText">Keyboard Shortcuts</div>
          <div id="keyboardIconBlue" class="menuOptionIconBlue" style="background-image: url(http://cosmos.phy.tufts.edu/~daniellangevagle/icons/keyboardblue.png?version=1);"></div>
        </div>
      </div>
      <div id="subMenuHeaders" class="subMenuHeaders">
        <div id="settingsHeader" class="subMenuHeader">
          <div id="settingsHeaderMap" class="settingsOption" style="color: white; background-color: #4187f5" onclick="showSubSettings(this.innerHTML.toLowerCase())">Map</div>
          <div id="settingsHeaderMarkers" class="settingsOption" onclick="showSubSettings(this.innerHTML.toLowerCase())">Markers</div>
          <div id="settingsHeaderData" class="settingsOption" onclick="showSubSettings(this.innerHTML.toLowerCase())">Data</div>
        </div>
        <div id="advancedSearchHeader" class="subMenuHeader">
          <div id="advancedSearchButtons" class="advancedSearchButtons"></div>
          <div class="subMenuButton" onclick="newAdvancedSearch()" style="position: absolute; top: 0px; left: 0px; width: 100px; margin: 5px 7px 5px 7px; font-size: 14px;">+ New Search</div>
          <div class="verticalLine" style="position: absolute; left: 114px; top: 0px; height: 100%; width: 2px;"></div>
        </div>
        <div id="keyboardHeader" class="subMenuHeader" style="height: 0px; border: none;"></div>
      </div>
      <div id="subMenus" class="subMenus">
        <div id="settings" class="subMenu">
          <div id="mapSettings" class="settingsContainer" style="display: block;">
            <div class="slidecontainer">
              <div class="menuText menuLeftEdge menuVertClose" style="display: block;">Brightness</div>
              <div class="brightnessIcon"></div>
              <input id="myRange" type="range" min="1" max="99" value="33" class="slider">
            </div>
            <div class="menuText menuLeftEdge menuVertClose" style="display: block;">Show/Hide</div>
            <div class="menuCheckboxes menuLeftEdge menuVertClose" onclick="mapSettingsCheckbox('cursorTrackerContainer')">
              <label for="cursorTrackerContainerCheckbox">
                <input id="cursorTrackerContainerCheckbox" type="checkbox" checked><span>Cursor Position</span>
              </label>
            </div>
            <br>
            <div class="menuCheckboxes menuLeftEdge menuVertClose" onclick="mapSettingsCheckbox('searchContainer')">
              <label for="searchContainerCheckbox">
                <input id="searchContainerCheckbox" type="checkbox" checked><span>Search Container</span>
              </label>
            </div>
            <br>
            <div class="menuCheckboxes menuLeftEdge" onclick="mapSettingsCheckbox('objectData')">
              <label for="objectDataCheckbox">
                <input id="objectDataCheckbox" type="checkbox" checked><span>Object Data</span>
              </label>
            </div>
            <div class="menuText menuLeftEdge" style="display: block;">Focus Circle Color</div>
            <div style="font-size: 0px; vertical-align: bottom;">
              <div id="focusCircleColorBox" class="circleContainer" style="border-color: #00ff00;" onclick="focusCircleColorFocus()"></div>
              <input id="focusCircleColor" type="text" autocorrect="off" autocapitalize="none" class="menuInput focusCircleColor" value="#00ff00" onkeydown="focusCircleColorInput(event, this.value)" onfocus="this.setSelectionRange(0, this.value.length)">
              <div title="Enter color" class="subMenuButton" style="width: 65px; margin: 5px 0 5px 0;" onclick="focusCircleColorChange(document.getElementById('focusCircleColor').value)">ENTER</div>
              <div title="Reset color" class="subMenuButton menuVertClose" style="width: 65px; margin: 5px 0 5px 0;" onclick="focusCircleColorChange('#00ff00')">RESET</div>
            </div>
            <div style="font-size: 0px; width: 100%; text-align: center;">
              <div id="focusCircleColorAlert" class="menuAlert"></div>
            </div>
          </div>
          <div id="markersSettings" class="settingsContainer" style="display: none;">
            <div class="menuText menuLeftEdge menuVertClose" style="display: inline-block; width: 110px;">Displayed Filter</div>
            <div class="autocomplete" style="height: 30px; width: calc(100% - 140px); vertical-align: top;">
              <input id="markerDispFilter" class="menuInput" type="text" autocorrect="off" autocapitalize="none" value="" style="width: 100%; " onfocus="markerDispFocus()" onkeydown="markerDispFilterKeyDown(event)" onblur="updateMarkerDispFilter()">
            </div>
            <div class="menuText menuLeftEdge menuVertClose" style="display: inline-block; width: 110px;">Min Zoom Level</div>
            <input id="markerMinZoomLevel" class="menuInput" value="" type="number" style="display: inline-block; width: calc(100% - 140px);" onfocus="markerZoomLevelFocus()" onkeydown="markerZoomLevelKeyDown(event)" onblur="updateMarkerZoomLevel()">
            <div class="menuText menuLeftEdge menuVertClose" style="display: inline-block; width: 110px;">Marker Size</div>
            <div id="xsmall" class="subMenuButton" style="width: calc(33% - 46px); margin-right: 0; background-color: #4187f5; color: white;" onclick="updateMarkerSize('small', true)">S</div>
            <div id="xmedium" class="subMenuButton" style="width: calc(33% - 46px); margin-left: 0; margin-right: 0;" onclick="updateMarkerSize('medium', true)">M</div>
            <div id="xlarge" class="subMenuButton" style="width: calc(33% - 45px); margin-left: 0;" onclick="updateMarkerSize('large', true)">L</div>
            <div class="menuText menuLeftEdge menuVertClose">Marker Colors & Bounds</div>
            <div id="mFilters" style="margin-bottom: 10px;"></div>
            <div id="markerDispFilterAutocompleteContainer" style="position: absolute; top: 25px; left: 130px; height: 0px; width: calc(100% - 140px);"></div>
          </div>
          <div id="dataSettings" class="settingsContainer" style="display: none;">
            <div class="menuText menuLeftEdge menuVertClose" style="display: inline-block;">Table</div>
            <div id="tableCheckboxButton" class="subMenuButton" style="width: 140px; margin: 5px 0 0 10px; display: block; font-size: 14px;" onclick="uncheckAllTable()">Check/Uncheck All</div>
            <div style="font-size: 0px; margin-bottom: 10px;">
              <div id="tableSettingsColOne" style="width: 50%; display: inline-block; vertical-align: top;"></div>
              <div id="tableSettingsColTwo" style="width: 50%; display: inline-block; vertical-align: top;"></div>
            </div>
            <div class="menuText menuLeftEdge menuVertClose" style="display: inline-block;">Figures</div>
            <div id="figureCheckboxButton" class="subMenuButton" style="width: 140px; margin: 5px 0 0 10px; display: block; font-size: 14px;" onclick="uncheckAllFigures()">Check/Uncheck All</div>
            <div style="font-size: 0px; margin-bottom: 10px;">
              <div id="figureSettingsColOne" style="width: 50%; display: inline-block; vertical-align: top;"></div>
              <div id="figureSettingsColTwo" style="width: 50%; display: inline-block; vertical-align: top;"></div>
            </div>
          </div>

        </div>
        <div id="advancedSearch" class="subMenu">
          <div id="tempASMessage" style="margin: 8px; height: 30px; width: calc(100% - 16px); text-align: center">Click + New Search to<br>create an Advanced Search</div>
        </div>
        <div id="keyboard" class="subMenu"><div class="keyboardShortcuts"></div></div>
      </div>
      <div id="menuBackground" class="menuBackground" onclick="hideMenu('background')"></div>

      <!-- Contains menu, field entry, ID entry, cursor location, filter buttons, marker buttons, scale bar, centering buttons and zoom controls -->
      <div id="fieldinputAutocompleteContainer" style="position: absolute; top: 42px; left: 10px; width: 300px;"></div>
      <div id="topLeftContainer" class="topLeftContainer">
        <form id="fieldInputForm" class="fieldInputForm" autocomplete="off">
          <div class="topVertical" style="left: 32px;"></div>
          <div class="autocomplete">
            <input id="fieldinput" class="field" type="text" autocorrect="off" onclick="hideMenu('fieldinput')" onfocus="fieldFocus()" onkeydown="fieldkeydown(event)">
          </div>
        </form>
        <!-- Cursor tracker contrainer -->
        <div id="cursorTrackerContainer" class="cursorTrackerContainer">
          <div id="cursorRADEC" class="cursorContainer">
            <span class="cursorColOne">RA</span><span class="cursorColTwo">-</span><span class="cursorColThree">DEC</span><span class="cursorColFour">-</span>
          </div>
          <div id="cursorXY" class="cursorContainer" style="margin-top: -1px;">
            <span class="cursorColOne">X</span><span class="cursorColTwo">-</span><span class="cursorColThree">Y</span><span class="cursorColFour">-</span>
          </div>
        </div>
        <!-- Object ID search form -->
        <div id="searchContainer" class="searchContainer">
          <form id="searchIDForm" class="searchIDForm" name="objidsearch" action="" method="post">
            <div class="searchColOne" onclick="document.getElementById('searchID').focus()">ID</div>
            <input id="searchID" class="searchInput" name="objid" type="number" autocomplete="off" onkeydown="objidkey(event, this.form)" min="1" step="1" onfocus="searchFocus()" onblur="searchBlur()">
          </form>
          <form id="searchRADECForm" class="searchRADECForm" name="radecsearch" action="" method="post">
            <div class="searchColOne" onclick="document.getElementById('searchRADEC').focus()">RA, DEC</div>
            <input id="searchRADEC" class="searchInput" name="radec" type="text" autocorrect="off" autocapitalize="none" autocomplete="off" onkeydown="radeckey(event, this.form)" onfocus="closeAdvSrch()">
          </form>
          <div class="searchHorizontal" style="top: 24px;"></div>
        </div>
        <!-- Scale bar for mobile device in portrait viewing mode -->
        <div id="filterButtonsContainer" class="buttonsContainer" onkeydown="mapkey(event)" onkeyup="mapkey(event)"></div>
      </div>
      <div id="topButtonsContainer" class="topButtonsContainer">
        <div style="font-size: 0px;">
          <div style="display: inline-block;">
            <div id="zoomControlContainer" class="zoomControlContainer" onkeydown="mapkey(event)" onkeyup="mapkey(event)">
              <button id="zoomInButton" class="zoomButton" type="button" title="Zoom in" onclick="zoomInMap()" onmousedown="zoomInGray()" onmouseup="zoomInWhite()">+</button>
              <button id="zoomOutButton" class="zoomButton" type="button" title="Zoom out" style="color: gray; background: #c8c8c8; cursor: default;" onclick="zoomOutMap()" onmousedown="zoomOutGray()" onmouseup="zoomOutWhite()">&minus;</button>
            </div>
            <div id="zoomLevelContainer" class="zoomLevelContainer">
              <form style="margin: 2px 0 0 0; padding: 0;"><input id="zoomLevel" class="zoomLevel" name="zoomnum" type="number" placeholder="0.00" onkeydown="zoomkey(event, this.form)"></form>
            </div>
          </div>
          <div style="font-size: 0px; display: inline-block; vertical-align: top;">
            <button id="zoomOutCenterButton" class="zoomOutCenterButton" type="button" title="Zoom out and center image" onclick="zoomOutCenterImageClick()"></button>
            <button id="focusCenterButton" class="focusCenterButton" type="button" title="Center on focus" onclick="focusCenterImageClick()"></button>
            <button id="xButton" class="xButton" type="button" title="Add object markers" onclick="addRemoveMarkers()"></button>
            <button id="advSrchButton" class="advSrchButton" style="padding: 0;" type="button" title="Advanced Search" onclick="advSrchButtonPress()">
              <div id="advSrchButtonCircle" style="margin: 0; padding: 0; width: 30px; height: 30px; border: 2px solid transparent; border-radius: 15px;"></div>
            </button>
            <button id="advSrchButtonLeft" class="advSrchButtonLeft" type="button" title="Previous search result" onclick="advSrchButtonNextPrev(-1)"></button>
            <button id="advSrchButtonRight" class="advSrchButtonRight" type="button" title="Next search result" onclick="advSrchButtonNextPrev(1)"></button>
            <div id="mobilePortraitScaleBarContainer" class="mobilePortraitScaleBarContainer">
              <div class="scaleBarVertical"></div>
              <div id="mobilePortraitScaleBarOne" class="scaleBarHorizontal"></div>
              <div class="scaleBarVertical" style="height: 10px; width: 1px;"></div>
              <div id="mobilePortraitScaleBarTwo" class="scaleBarHorizontal"></div>
              <div id="mobilePortraitScaleBarExtraTick1" class="scaleBarVertical" style="height: 10px; width: 1px; display: none;"></div>
              <div id="mobilePortraitScaleBarThree" class="scaleBarHorizontal" style="display: none;"></div>
              <div id="mobilePortraitScaleBarExtraTick2" class="scaleBarVertical" style="height: 10px; width: 1px; display: none;"></div>
              <div id="mobilePortraitScaleBarFour" class="scaleBarHorizontal" style="display: none;"></div>
              <div class="scaleBarVertical"></div>
              <div id="mobilePortraitScaleBarValue" class="scaleBarValue"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Object information container with linked ID and data table -->
      <div id="objectInfo" class="objectInfo">
        <div class="objectHeader enableTextHighlight"><big>Selected Object</big></div>
        <div id="objectLink" class="objectLink enableTextHighlight">Click on an object</div>
        <button id="tableButton" class="tableButton" title="Show table" onclick="showHideTable()"></button>
        <button id="figuresButton" class="figuresButton" title="Show figures" onclick="showHideFigures()"></button>
      </div>
      <div id="objectTableContainer" class="objectTableContainer enableTextHighlight">
        <div id="objectTableDiv" class="objectTable">
          <div id="objectTable" style="position:relative; width: 100%; display: none; z-index: 1000;"></div>
        </div>
      </div>

      <!-- Figures container -->
      <div id="mobilePortraitFiguresContainerBackground" class="mobilePortraitFiguresContainerBackground"></div>
      <div id="figuresContainer" class="figuresContainer"></div>
      <div id="figureZoomInBackground" class="figureZoomInBackground" onclick="figureZoomIn(-1)"></div>
      <div id="zoomFigsContainer" class="zoomFigsContainer" onclick="figureZoomIn(-1)" onkeydown="figurezoomkeydown(event)"></div>

      <div id="loadingBackground" style="position: absolute; top: 0; left: 0; height: 100%; width: 100%; background: black; z-index: 9999;"><div class="loadingContainer"><div class="loader"></div></div></div>

      <div id="tempAlert" class="tempAlert"></div>

      <!--<div id="testMessage" style="position: absolute; top: 10px; right: 10px; z-index: 9999; background: black; color: red;"></div>-->

      <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
      <script src="http://cosmos.phy.tufts.edu/~daniellangevagle/js/w3color.js"></script>
      <script src="http://cosmos.phy.tufts.edu/~daniellangevagle/js/multirange.js"></script>
      <script src="http://cosmos.phy.tufts.edu/~daniellangevagle/js/astro-id_v2.js?version=0.57"></script>
      <script>

        var fields =
          ["j142518+342815","j142629+333903","j142611+340256","j142753+342956","j142517+325118","j142905+342555",
          "j142917+343704","j143217+343556","j143223+333158","j143107+345938","j143238+343654","j142913+335700",
          "j143351+332544","j143217+325255","j143446+351937","j143223+325006","j143430+342703","j143700+345938",
          "j004403-203346","j142446+350339","j142633+350827","j022644-044142","j142724+334246","j143805+341355",
          "j143312+330639","j021820-051015","j021744-034532","j144915+085609","j011651-205208","j012016p2134",
          "j023507-040202","j051707-441055","j075054+425215","j080015+403000","j081331+254507","j095804-290401",
          "j101725+611630","j101827+053025","j101956+274406","j104831+444427","j105231+080603","j110326+344948",
          "j112443-170520","j112914+095154","j113007-144930","j113103-270513","j130033+400907","j131718+392526",
          "j135817+575208","j143748-014709","j151005+595848","j151508+213346","j152424+095826","j163201+373751",
          "j163429+703133","j175334+631044","j203924-251434","j222743-270502","j225453+185700","j235536-000300",
          "j010806+163552","j001452+091221","j010311+131615","j003442-430813","j020951-000458","j014516-094518",
          "j003643-441055","j045213-164012","j003548-431221","j082107+310748","j083852+025700","j082946+185222",
          "j091730+324106","j095432+354022","j110742+102121","j101154+294142","j104733+574124","j113233+380350",
          "j120342+102833","j120639+025302","j144453+291901","j121931+494058","j105105+581807","j160454+381156",
          "j155153+191102","j162548+264655","j170059+641203","j163851+403856","j163437+402219","j161642+554528",
          "j161313+564948","j220852-194355","j234627+124850","j021523-034330","j022217-042146","j143529+340213",
          "j022203-041210","j001353-302255","j041544-240209","j041556-240946","j071716+374948","j023944-014019",
          "j001421-302949","j023931-013144","j074508+392215","j071801+374720","j134709-114734","j114940+221800",
          "j115001+222522","j134719-114004","j142407+240032","j142409+240827","j212931-073538","j212950-074203",
          "j224845-443748","j224918-443242","j074520+393007","j033239-274727","j033240-274644","j112409+420216",
          "j034217-203206","j050212+073119","j114423+071301","j134226+184156","j120925+454326","j140814+565638",
          "j144603+035421","j142925+322446","j140221+094546","j150502+294658","j161500-093928","j142706+575248",
          "j132946-234500","j020924-044344","j094854+134937","j011008-022356","j120834+454358","j101059-044622",
          "j170050+641734","j105906-124622","j105834-125334","j113812-113422","j113734-112522","j113848-113430",
          "j113738-113104","j113852-114012","j113817-114004","j122816-113140","j122754-114048","j130103-112942",
          "j130121-113242","j130103-113657","j130144-114702","j122758-113556","j130131-113650","j130132-114221",
          "j105852-125045","j141800+523112","j141923+525013","j021726-051246","j112734+115454","j100025+021706",
          "j001516-795544","j004830-124807","j000535-501218","j004857+051818","j010005-510939","j001146-065255",
          "j002322+154236","j005857-360227","j012413-584413","j010056+022602","j012245-283813","j012509+213914",
          "j010636+150842","j013717-090856","j013649+412931","j012536-000050","j014124+133733","j014848+185721",
          "j015017+130412","j020203-112718","j015438+045309","j015526-090227","j015942+134102","j021620-390227",
          "j021338+125457","j022035+003549","j024320-721124","j024043-081427","j021226-073213","j023256-372157",
          "j024651-010458","j024454-300202","j024636-303202","j024704-300314","j025458-082338","j030741-724434",
          "j024835-303332","j023455-040639","j024940+271857","j031539-214037","j032213-175555","j031910-324958",
          "j031820-165219","j035145-142530","j032601-164340","j041100+182219","j042612+050516","j042153+142146",
          "j035740-133000","j031948-214843","j043755-110618","j044053-431709","j044923+031940","j045548-220151",
          "j045009+065504","j050116-041438","j050211-070039","j052043-252512","j053002-072320","j064340+753733",
          "j072404+332327","j080230+185815","j053152-072320","j081605+215204","j083728+442732","j083903+651026",
          "j074531+195219","j084328+261640","j084219+140903","j083917+645602","j085027+444818","j084517+225457",
          "j085244+030910","j085839+290849","j091029+332732","j090812+324601","j091048+101720","j091102+333057",
          "j091136+183209","j091103+325125","j091542+475801","j091748+272302","j091922+551843","j091440+475446",
          "j092507+485703","j092607+123852","j092755+602703","j092130+450708","j093458+020202","j093546+142746",
          "j093626+320946","j093826+071001","j093658+293144","j094316+052736","j094438-194113","j094646+471456",
          "j094703+512606","j094943+544340","j095057+354420","j095058+114546","j095301+635540","j095910+504030",
          "j095914+554912","j100307+324525","j100337+285519","j100445+525913","j100518-242139","j100104+502403",
          "j100532-230509","j100543+370610","j085359+435157","j100634+233737","j100655-295327","j100525+012952",
          "j100741+100412","j100741+501315","j100842+071109","j100938+300050","j100714+363538","j101620+592501",
          "j101621-274554","j101114-043932","j101933+274218","j102055+343412","j102305+393256","j102441-184348",
          "j071835+742551","j102442+481058","j102320+040842","j102818+391713","j103520+054734","j103422-283104",
          "j104237+074648","j100813+120252","j104649+130234","j104732+130531","j104058+060730","j104905+021500",
          "j110017+121337","j104802+151543","j110108+104803","j105959+403842","j110216+051912","j110217+105425",
          "j110218+205208","j104822+130350","j110349-324724","j111349+293032","j111215+353654","j102711+183531",
          "j111515+525558","j111447+023552","j111731+263202","j111534+425132","j111946+041019","j111855+021709",
          "j112224+575056","j112417+113140","j112521+532045","j112619-014322","j112855-042526","j112923+602400",
          "j113115+155833","j113149+133303","j113306+032801","j113701+014655","j113516+255902","j114149+264004",
          "j114237+301626","j114657-141145","j114712-140516","j114108+113748","j115051-203346","j115451+574218",
          "j115455+194012","j115706+321908","j115731+090654","j120137-135652","j115151+544040","j120259+480520",
          "j121047+365728","j120856+261330","j121825+291008","j121838+291832","j121838+294413","j121841+295251",
          "j122054-020444","j122002+292204","j122048+454427","j122425+611152","j122513-024908","j121324-134019",
          "j122136+043556","j122917+104402","j123044+823621","j123141-022707","j122754+441109","j123214+060122",
          "j123243-003336","j123134+120458","j123316+475327","j122944+074825","j123626+264351","j123536-394958",
          "j123727+012519","j124105+285027","j123742+115421","j124241+353751","j124146+321640","j124444+021716",
          "j124423+172540","j124825+174142","j125041-233155","j125028+394738","j125124+463303","j124812+175139",
          "j125630+322804","j125659+543115","j125749-331257","j130346+295302","j130103+275024","j130512-103527",
          "j130411+310910","j130520-253806","j131932+272638","j131452+261145","j132155+464832","j132342+343509",
          "j132754+524832","j132722+443039","j133022+281102","j133940-000307","j133515+080144","j132530+223318",
          "j134145+050346","j134341+184402","j134808+245222","j134055+282432","j134829+263318","j135058+275208",
          "j135313+361930","j134918-342204","j135415+180234","j135324+032942","j135524+004644","j135651+170234",
          "j140028+572414","j140512+465920","j135721+192251","j140603+250722","j141011+295450","j141339+440531",
          "j141519+045006","j141927+060650","j142030+530148","j142046+254109","j142309+000151","j142555+003914",
          "j142703+235313","j142711+263115","j134031+412309","j142851+524001","j142942+022045","j143130+244742",
          "j143158+095837","j143851+390730","j144444+342746","j145044+270943","j145236+313737","j145416+161026",
          "j145647+532443","j150006+531413","j150022+412754","j150508+564409","j150538+033918","j150907+373010",
          "j122628+052302","j151112+402540","j151216+012700","j151313+363321","j151915+283531","j151957+253032",
          "j152019-250000","j151411+361557","j152110+594030","j152449+002508","j152503+042316","j152827+282052",
          "j141019+230115","j140941+262208","j153230+302320","j153444+501449","j153454+125215","j153817+573050",
          "j153957-020516","j153714+543151","j154457+484521","j154511+115454","j154533+093404","j152407+095454",
          "j155022+395920","j155145+200552","j154743+205746","j155242+571033","j155631+210758","j154259-105052",
          "j155657+634500","j160315+572952","j155451+362400","j160459+144633","j160527+254800","j160849+601416",
          "j161142+522154","j161650+063643","j162524+572157","j165904+373549","j165930+373000","j170042+620415",
          "j170043+292240","j170133+640758","j161348+263018","j170311+613603","j171458+045544","j171654+660256",
          "j183228+534449","j172009+480545","j184730-685837","j200544-413957","j173921+455512","j201459-265855",
          "j202203-311236","j203825-202132","j204029-064434","j205629-044807","j213147-120224","j213350-490513",
          "j210407-072302","j213738-143813","j213911-382512","j214412+144846","j215704+224648","j223758-184207",
          "j224552-465118","j222542-721301","j220526-001749","j225410+161322","j225336-064507","j231616-422942",
          "j232234-345042","j232251-702848","j230712+211127","j232501-403621","j232946+253144","j232836+051008",
          "j224845-801040","j233516-353618","j233334+392226","j234501+151001","j234506-423936","j235819-101503",
          "j235101-432331","j232509-121214","j143729-014948"];

        var fieldName, infoJSON, groupJSON, xyJSON, indJSON;
        var group, mainDir, figures, initialxySize, finalxySize, pixscl,
            filters, defaultFilter, catNames, figNames, good_catNames,
            good_figNames, tableNames, maxID, maxBCG, minRA, maxRA, minDEC,
            maxDEC;
        var cTCCheckbox, sCCheckbox, defaultMarkerZoomLevel;
        var numFilterRows = 1;
        var tableButton = document.getElementById("tableButton");
        var figuresButton = document.getElementById("figuresButton");
        var slider = document.getElementById("myRange");
        var bright = false;
        var command = false;

        var data = {};
        var prevdata = {};
        var objectMarkers = {};
        var IDs = [];

        var portrait = $(window).height()>$(window).width();
        var mobile = (/iphone|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase()));
        var ipad = (/ipad/i.test(navigator.userAgent.toLowerCase()));

        var map;
        var focusCircle;
        var currentFocusValue;
        var fCLat;
        var fCLng;
        var baseMaps = {};
        var currentLayer;
        var qvLayers = [];
        var qvbcgs = true;
        var bcgsLayer = true;
        var iwHt, iwWd, wMin, imDisp, y_start, y_end, x_start, x_end, bounds, zDelta, mapMaxZoom;
        var mapkeys = {};

        var fcb = document.getElementById("focusCenterButton");

        var asb = document.getElementById("advSrchButton");
        var currentAdvSrch = -1;
        var lastAdvSrch = -1;
        var advSrchColors = ["#e77e23","#3598db","#f1c40e","#9b58b5","#e84c3d","#95a5a5"]
        var advSrchShow = [];
        var advSrchCount = 0;
        var iASlat;
        var iASlng;

        var lastCenter = "image";
        var cntLat, cntLng;
        var focusOffsetLat = 0;
        var focusOffsetLng = 0;

        var markerSize = "small";

        setTimeout(function() {
          document.getElementById("loadingBackground").style.zIndex = "999";
        }, 4000)

        // check for user url input and load scale bar
        window.onload = function() {
          var url = window.location.search.substring();
          var origFieldName;
          var zoomLevel = 0;
          var userid = 0;
          var userra;
          var userdec;
          var showTable = 0;
          var showFigures = 0;
          var updateMS = false;
          var updateMarkers = false;
          var changeBL = "";
          var userbcgs = "1";
          var portrait = $(window).height()>$(window).width();
          if (url.includes("?")) {
            if (url.includes("advancedsearch=")) {
              advancedSearches = url.split("advancedsearch=")[1].split("}]")[0]+"}]"
              var input = url.replace(advancedSearches, '').split("?");
            } else {
              var input = url.split("?");
            }
            for (j=0; j<input.length; j++) {
              if (input[j].includes("&") & !input[j].includes(fieldName+"/")) {
                inputPairs = input[j].split("&");
              } else {
                inputPairs = [input[j]];
              }
              for (i=0; i<inputPairs.length; i++) {
                if (inputPairs[i] != "" & inputPairs[i].includes("=")) {
                  inputKey = inputPairs[i].split("=")[0]
                  inputValue = inputPairs[i].split("=")[1]
                  if (inputKey != "" && inputValue != "") {
                    goodKey = ["field", "fieldname"]
                    if (goodKey.includes(inputKey.toLowerCase())) {
                      origFieldName = inputValue;
                      if (fields.includes(inputValue)) {
                        fieldName = inputValue;
                      } /*else {
                        // rename field names for Abell and MACS (HFF)
                        fieldName = inputValue.toLowerCase().replace(/%20/g,'');
                        fieldName = fieldName.split(".")[0]
                        fieldName = fieldName.replace(/-/g,'');
                        fieldName = fieldName.replace(/%2B/g,'');
                        if (inputValue.toLowerCase().includes("m")) {
                          fieldName = fieldName.replace("macsj","M").replace("macs","M").replace("m","M");
                        } else if (inputValue.toLowerCase().includes("a")) {
                          fieldName = fieldName.replace("abells","A").replace("abell","A").replace("a","A");
                        }
                        fieldName =
                          fieldName.replace(
                            "cluster","clu").replace("clu","-clu").replace("parallel", "par").replace("par","-par")
                        if (!fieldName.includes("clu") & !fieldName.includes("par")) {
                          fieldName = fieldName + "-clu";
                        }
                      }*/
                    }
                    goodKey = ["zoom", "zl"]
                    if (goodKey.includes(inputKey.toLowerCase())) {
                      zoomLevel = Number(inputValue);
                    }
                    goodKey = ["id"]
                    if (goodKey.includes(inputKey.toLowerCase())) {
                      userid = Number(inputValue);
                    }
                    goodKey = ["data", "d"]
                    goodValue = ["true", "1"]
                    if (goodKey.includes(inputKey.toLowerCase()) && goodValue.includes(inputValue.toLowerCase())) {
                      showTable = 1;
                      showFigures = 1;
                    }
                    goodKey = ["table", "t"]
                    goodValue = ["true", "1"]
                    if (goodKey.includes(inputKey.toLowerCase()) && goodValue.includes(inputValue.toLowerCase())) {
                      showTable = 1;
                    }
                    goodKey = ["fig", "f"]
                    goodValue = ["true", "1"]
                    if (goodKey.includes(inputKey.toLowerCase()) && goodValue.includes(inputValue.toLowerCase())) {
                      showFigures = 1;
                    }
                    goodKey = ["ms", "markersize"]
                    goodValue = ["small", "s", "medium", "m", "large", "l"]
                    if (goodKey.includes(inputKey.toLowerCase()) && goodValue.includes(inputValue.toLowerCase())) {
                      if (inputValue == "s") { inputValue = "small"; }
                      else if (inputValue == "m") { inputValue = "medium"; }
                      else if (inputValue == "l") { inputValue = "large"; }
                      markerSize = inputValue.toLowerCase();
                      updateMS = true;
                    }
                    goodKey = ["markers", "marker", "x"]
                    goodValue = ["true", "1"]
                    if (goodKey.includes(inputKey.toLowerCase()) && goodValue.includes(inputValue.toLowerCase())) {
                      updateMarkers = true;
                    }
                    goodKey = ["filter", "band"]
                    if (goodKey.includes(inputKey.toLowerCase())) {
                      changeBL = inputValue.toLowerCase();
                    }
                    if (inputKey.toLowerCase() == "bcgs") {
                      userbcgs = inputValue.toLowerCase();
                    }
                    if (inputKey.toLowerCase() == "radec") {
                      if (inputValue.includes('(') & inputValue.includes(')') & inputValue.includes(',')) {
                        userra = Number(inputValue.split('(')[1].split(',')[0].replace(/%20/g,'').trim());
                        userdec = Number(inputValue.split(')')[0].split(',')[1].replace(/%20/g,'').trim());
                      } else if (inputValue.includes(',')) {
                        userra = Number(inputValue.split(',')[0].replace(/%20/g,'').trim());
                        userdec = Number(inputValue.split(',')[1].replace(/%20/g,'').trim());
                      } else if (inputValue.includes('(') & inputValue.includes(')') & inputValue.includes(' ')) {
                        userra = Number(inputValue.split('(')[1].split('%20')[0].trim());
                        userdec = Number(inputValue.split(')')[0].split('%20').slice(-1)[0].trim());
                      } else if (inputValue.includes('%20')) {
                        userra= Number(inputValue.split('%20')[0].trim());
                        userdec = Number(inputValue.split('%20').slice(-1)[0].trim());
                      }
                    }
                    if (inputKey.toLowerCase() == "ra") {
                      userra = Number(inputValue);
                    }
                    if (inputKey.toLowerCase() == "dec") {
                      userdec = Number(inputValue);
                    }
                  }
                }
              }
            }
          }

          // Default field is j012016p2134
          if (!fields.includes(fieldName)) { fieldName = "j012016p2134"; }
          if (origFieldName == undefined) {
            newurl(window.location.toString()+"?field="+fieldName);
          } else {
            newurl(window.location.toString().replace(origFieldName, fieldName));
          }

          // load in relevant JSON files and variables, set up the map and menu
          setup(true);

          if (showTable == 1) {
            showHideTable();
          }
          if (showFigures == 1) {
            showHideFigures();
          }

          if (changeBL != "") {
            if (filters.includes(changeBL)) {
              changeBaseLayer(changeBL);
            }
          }
          if (filters.includes("bcgs") & userbcgs == "0" & changeBL != "seg") {
            changeBaseLayer("bcgs");
          }
          if (groupJSON.hasOwnProperty("defaultMarkerOptions")) {
            if (updateMS) {
              updateMarkerSize(markerSize, false);
            }
            createMarkers();
            if (updateMarkers) {
              if (groupJSON.hasOwnProperty("defaultMarkerOptions")) {
                setTimeout(addRemoveMarkers, 1000);
              }
            }
          }
          if (userid != 0) {
            document.getElementById("searchID").value = userid;
            fcb.style.cursor = "pointer";
            getobj(document.getElementById("searchIDForm"), zoomLevel, 1);
            if (userra>=minRA && userra<=maxRA && userdec>=minDEC && userdec<=maxDEC) {
              y = decy(userdec);
              lat = ylat(y) + focusOffsetLat;
              x = rax(userra);
              lng = xlng(x) + focusOffsetLng;
              map.setView(new L.LatLng(lat, lng), zoomLevel);
            } else {
              focusCenterImage(zoomLevel);
            }
          } else if (userra>=minRA && userra<=maxRA && userdec>=minDEC && userdec<=maxDEC) {
            //check to make sure within bounds of map
            y = decy(userdec);
            lat = ylat(y) + focusOffsetLat;
            x = rax(userra);
            lng = xlng(x) + focusOffsetLng;
            userLocationRADEC(userra, userdec, zoomLevel)
            focusCenterImage(-1);
          } else {
            map.setView(new L.LatLng(ylat(finalxySize[1]/2.), xlng(finalxySize[0]/2.)), zoomLevel);
          }
          if (zoomLevel == 0 && document.getElementById("searchID").value == "") {
            zoomOutCenterImage();
          }
          // url advanced search
          if (url.includes("advancedsearch=")) {
            urlAdvancedSearches(advancedSearches)
          }
        }

        $(window).on("resize", function() {
          $("#map").height($(window).height()).width($(window).width());
          map.invalidateSize();

          wHt = $(window).height();
          wWd = $(window).width();
          map.setMaxBounds([[y_start-(wHt/2.), x_start-(wWd/2.)], [y_end+(wHt/2.), x_end+(wWd/2.)]]);

          portrait = wHt > wWd;

          // no overlapping with table
          if (mobile & portrait) {
            document.getElementById("topLeftContainer").style.width = "calc(100% - 10px)";
            document.getElementById("fieldInputForm").style.width = "100%";
            document.getElementById("fieldinputAutocompleteContainer").style.top = "40px";
            document.getElementById("fieldinputAutocompleteContainer").style.left = "5px";
            document.getElementById("fieldinputAutocompleteContainer").style.width = "calc(100% - 10px)";
            document.getElementById("searchContainer").style.width = "100%";
            document.getElementById("menuContainer").style.width = "calc(100% - 10px)";
            // adjust button width
            filterButtons = document.getElementsByClassName("layerButton");
            buttonWidth = 0;
            buttonsPerRow = filters.length;
            i = -1;
            while (buttonWidth < 55.) {
              i++
              if (i == 0) {
                buttonWidth = ($(window).width() - 10)/(buttonsPerRow);
              } else {
                buttonWidth = ($(window).width() - 10)/(buttonsPerRow - i);
              }
            }
            buttonsPerRow = buttonsPerRow - i;
            for (b=0; b<filterButtons.length; b++) {
              button = filterButtons[b];
              button.style.width = buttonWidth+"px";
            }
            numFilterRows = Math.ceil(filters.length/buttonsPerRow);
            document.getElementById("tempAlert").style.top = (136 + 32*numFilterRows + 49*sCCheckbox)+"px";
            document.getElementById("tempAlert").style.left = "5px";
            document.getElementById("filterButtonsContainer").style.width = "100%";
            document.getElementById("objectInfo").style.width = "100%";
            document.getElementById("objectInfo").style.left = "0px";
            document.getElementById("objectInfo").style.bottom = "0px";
            if (figuresButton.style.backgroundImage.includes("blue")) {
              tableDivMarginBottom = Math.max($(window).height()*0.16, 79) + 52;
              tableMaxHeight =
                Math.min(($(window).height()*0.5), ($(window).height() - (136 + 32*numFilterRows + 49*sCCheckbox)));
              document.getElementById("objectTableDiv").style.marginBottom = tableDivMarginBottom+"px";
              document.getElementById("objectTableContainer").style.maxHeight = tableMaxHeight+"px";
            } else {
              tableMaxHeight =
                Math.min(($(window).height()*0.4), ($(window).height() - (136 + 32*numFilterRows + 49*sCCheckbox)));
              document.getElementById("objectTableDiv").style.marginBottom = "52px";
              document.getElementById("objectTableContainer").style.maxHeight = tableMaxHeight+"px";
            }
            document.getElementById("objectTableContainer").style.left = "0px";
            document.getElementById("objectTableContainer").style.bottom = "0px";
            document.getElementById("objectTableContainer").style.width = "100%";
            if (figuresButton.style.backgroundImage.includes("blue")) {
              document.getElementById("mobilePortraitFiguresContainerBackground").style.display = "block";
            }
            document.getElementById("figuresContainer").style.height = $(window).height()*0.16+"px";
            document.getElementById("figuresContainer").style.maxWidth = "100%";
            document.getElementById("figuresContainer").style.left = "0px";
            document.getElementById("figuresContainer").style.bottom = "52px";
          } else if (mobile & !portrait) {
            document.getElementById("tempAlert").style.top = "8px";
            document.getElementById("tempAlert").style.left = "315px";
            document.getElementById("topLeftContainer").style.width = "300px";
            document.getElementById("fieldInputForm").style.width = "100%";
            document.getElementById("fieldinputAutocompleteContainer").style.top = "40px";
            document.getElementById("fieldinputAutocompleteContainer").style.left = "5px";
            document.getElementById("fieldinputAutocompleteContainer").style.width = "300px";
            document.getElementById("searchContainer").style.width = "100%";
            document.getElementById("menuContainer").style.width = "300px";
            document.getElementById("filterButtonsContainer").style.width = "100%";
            // adjust button width
            filterButtons = document.getElementsByClassName("layerButton");
            if (filters.length >= 5) {
              filtersPerRow = 5;
            } else { filtersPerRow = filters.length; }
            if (filtersPerRow < 3) { filtersPerRow = 3; }
            for (b=0; b<filterButtons.length; b++) {
              button = filterButtons[b];
              layerButtonWidth = 300./filtersPerRow + "px";
              button.style.width = layerButtonWidth;
              button.style.backgroundSize = layerButtonWidth+" 32px";
            }
            numFilterRows = Math.ceil(filters.length/filtersPerRow);
            document.getElementById("mobilePortraitFiguresContainerBackground").style.display = "none";
            document.getElementById("figuresContainer").style.maxWidth = "calc(100% - 305px)";
            document.getElementById("figuresContainer").style.background = "transparent";
            document.getElementById("figuresContainer").style.left = "305px";
            document.getElementById("figuresContainer").style.bottom = "8px";
            document.getElementById("objectTableDiv").style.marginBottom = "52px";
            document.getElementById("objectTableContainer").style.maxHeight =
              ($(window).height() - 144 - 32*numFilterRows - 49*sCCheckbox)+"px";
            document.getElementById("objectTableContainer").style.width = "300px";
            document.getElementById("objectTableContainer").style.left = "5px";
            document.getElementById("objectTableContainer").style.bottom = "8px";
            document.getElementById("objectTable").style.width = "100%";
            document.getElementById("objectInfo").style.width = "300px";
            document.getElementById("objectInfo").style.left = "5px";
            document.getElementById("objectInfo").style.bottom = "8px";
            if (document.getElementById("searchID").value != "") {
              // reload table by executing getid function
              fCX = Math.round(lngx(focusCircle.getLatLng().lng));
              fCY = Math.round(laty(focusCircle.getLatLng().lat));
              getid(fCX, fCY);
            }
          } else {
            document.getElementById("objectTableContainer").style.maxHeight =
              ($(window).height() - 248 - 32*numFilterRows)+"px";
          }

          if (document.getElementById("zoomFigsContainer").style.display == "block") {
            figs = document.getElementsByClassName("figure");
            good = [];
            minheight = $(window).height()*0.8;
            maxwidth = 0;
            for (f=0; f<figs.length; f++) {
              if (figs[f].id.includes("zoom") & figs[f].style.display == "inline-block") {
                figs[f].style.display = "none";
                figs[f].style.display = "inline-block";
                good.push(figs[f]);
                ht = $(figs[f]).height();
                wd = $(figs[f]).width();
                if (ht < minheight) {
                  minheight = ht;
                }
                if (wd > maxwidth) {
                  maxwidth = wd;
                  if ((ht*0.9*$(window).width()/wd) < minheight) {
                    minheight = (ht*0.9*$(window).width()/wd);
                  }
                }
              }
            }
            minheight = Math.max(minheight, 0.5*$(window).height())
            document.getElementById("zoomFigsContainer").style.height = minheight + "px";
            document.getElementById("zoomFigsLeft").style.width =
              Math.max(0, ($(window).width() - $(good[0]).width())/2.) + "px";
            document.getElementById("zoomFigsRight").style.width =
              Math.max(0, ($(window).width() - $(good[good.length-1]).width())/2.) + "px";
            document.getElementById("zoomFigsContainer").style.bottom =
              ($(window).height() - $(good[0]).height())/2. + "px";
            document.getElementById("zoomFigsContainer").scrollLeft +=
              $(document.getElementById("zoomfigure"+figNames[num])).position().left - $(window).width()/2. +
              $(document.getElementById("zoomfigure"+figNames[num])).width()/2.;
          }
          menuSizing();
          advancedSearchResizeFilterBounds();
          if (fcb.style.backgroundImage.includes("blue") & lastCenter == "focus") {
            focusCenterImage(-1);
          } else if (document.getElementById("zoomOutCenterButton").style.backgroundImage.includes("blue") &&
                     map.getZoom() == 0) {
            zoomOutCenterImage();
          }
        }).trigger("resize");

      </script>
    </div>
  </body>
</html>
